Mon Feb  2 21:26:42 2026       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 565.57.01              Driver Version: 565.57.01      CUDA Version: 12.7     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A6000               On  |   00000000:57:00.0 Off |                  Off |
| 30%   26C    P8             20W /  300W |       2MiB /  49140MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Using device: cuda
Setting random seed to 77
Loading/Processing training data from: data/visium_lymph_node.h5ad
Processing data from H5/H5AD: data/visium_lymph_node.h5ad for train set.
Parameters: k=30, PE_dim=50, Gene Threshold=20, PCA Neighbors=50
SPLIT: Using TRAINING set (first 80%): 3228 cells.
Warning: No counts layer/raw found. Inferred counts from X and stored in layers['counts'].
Initial GEX data shape: 3228 cells, 36601 genes.
Using counts from: layers['counts']
Filtering genes expressed in fewer than 20 cells.
Number of genes after filtering: 17961
Building FEATURE graph (k=30) on PCA-reduced expression.
FEATURE Graph built: 138278 edges.
Building PHYSICAL graph (k=30) on Spatial Coordinates.
PHYSICAL Graph built: 103210 edges.
Computing Laplacian PE with dim 50...
Processed and saved data to data/spatial_processed/train_k30/processed/spatial_train_k30_pe50_gt20_pca50.pt
Saved metadata to data/spatial_processed/train_k30/processed/spatial_train_k30_pe50_gt20_pca50_metadata.pt
Processed file or metadata not found. Dataset will be processed.
Processing data from H5/H5AD: data/visium_lymph_node.h5ad for train set.
Parameters: k=30, PE_dim=50, Gene Threshold=20, PCA Neighbors=50
SPLIT: Using TRAINING set (first 80%): 3228 cells.
Warning: No counts layer/raw found. Inferred counts from X and stored in layers['counts'].
Initial GEX data shape: 3228 cells, 36601 genes.
Using counts from: layers['counts']
Filtering genes expressed in fewer than 20 cells.
Number of genes after filtering: 17961
Building FEATURE graph (k=30) on PCA-reduced expression.
FEATURE Graph built: 138278 edges.
Building PHYSICAL graph (k=30) on Spatial Coordinates.
PHYSICAL Graph built: 103210 edges.
Computing Laplacian PE with dim 50...
Processed and saved data to data/spatial_processed/train_k30/processed/spatial_train_k30_pe50_gt20_pca50.pt
Saved metadata to data/spatial_processed/train_k30/processed/spatial_train_k30_pe50_gt20_pca50_metadata.pt
Successfully loaded processed data from data/spatial_processed/train_k30/processed/spatial_train_k30_pe50_gt20_pca50.pt
Loaded metadata: 17961 filtered gene names, 3 cell types (['B cell', 'CD4-positive, alpha-beta T cell', 'lung pericyte']...).
Training data: 3228 cells, 17961 genes, 3 types.
Detected Chromatin Context Dim: 0

Initializing Trainer...
Using loss weights: {'diff': 0.5, 'kl': 0.05, 'rec': 3.0}
Input masking fraction: 0.0
Multimodal Context Dim: 0
Encoder type: transformer
Dual graph: False, Spectral loss weight: 0.0, Mask-rec weight: 0.0
KL anneal steps: 200, KL free bits: 0.5
Batch adv weight: 0.0, Context align weight: 0.0
Mask strategy: random
Gene stats weight: 1.5, Zero-rate weight: 0.25
Cell zero-rate weight: 0.5
Gene stats anneal steps: 200, Zero-rate anneal steps: 200
Disable KL: False
Cell-type loss weight: 0.5, Dispersion weight: 0.2
Libsize weight: 2.0
Pi temperature: 1.0, Pi bias: -0.2, Diffusion temperature: 1.0, Pi blend: 0.005
Gen calibrate means: True, Gen calibrate zero: True
Gen match zero per cell: True, Strength: 0.8
Gen mean scale clip: [0.1, 10.0]
Diffusion method: sde, Simple mode: False
Bio positional: False, Bio pos dim: 32
Transformer layers: 4, heads: 8, dropout: 0.1
Trainer initialized.

Starting training for 200 epochs...
Checkpoint frequency: Every 20 epochs (approx 10% of total time).
Stage 1: diffusion loss off; denoiser frozen.
Epoch 001/200 Summary -> Total: 193.8404, Diff: 0.0000, KL: 0.5454, Rec: 1.4497, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.2456, ZeroRate: 0.0983, CellZeroRate: 0.0068, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 002/200 Summary -> Total: 193.8136, Diff: 0.0000, KL: 0.5451, Rec: 1.4498, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.2453, ZeroRate: 0.0983, CellZeroRate: 0.0068, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 003/200 Summary -> Total: 193.9062, Diff: 0.0000, KL: 0.5451, Rec: 1.4496, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.2453, ZeroRate: 0.0983, CellZeroRate: 0.0068, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 004/200 Summary -> Total: 194.0069, Diff: 0.0000, KL: 0.5454, Rec: 1.4494, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.2451, ZeroRate: 0.0983, CellZeroRate: 0.0068, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 005/200 Summary -> Total: 193.8493, Diff: 0.0000, KL: 0.5454, Rec: 1.4494, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.2454, ZeroRate: 0.0983, CellZeroRate: 0.0068, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 006/200 Summary -> Total: 193.9085, Diff: 0.0000, KL: 0.5452, Rec: 1.4500, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.2456, ZeroRate: 0.0983, CellZeroRate: 0.0068, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 007/200 Summary -> Total: 194.0434, Diff: 0.0000, KL: 0.5453, Rec: 1.4491, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.2455, ZeroRate: 0.0983, CellZeroRate: 0.0068, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 008/200 Summary -> Total: 193.5191, Diff: 0.0000, KL: 0.5451, Rec: 1.4492, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.2455, ZeroRate: 0.0983, CellZeroRate: 0.0068, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 009/200 Summary -> Total: 193.6834, Diff: 0.0000, KL: 0.5454, Rec: 1.4497, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.2453, ZeroRate: 0.0983, CellZeroRate: 0.0068, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 010/200 Summary -> Total: 178.7564, Diff: 0.0000, KL: 0.5525, Rec: 1.4365, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.2323, ZeroRate: 0.0975, CellZeroRate: 0.0068, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 011/200 Summary -> Total: 166.5519, Diff: 0.0000, KL: 0.5615, Rec: 1.4260, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.2196, ZeroRate: 0.0968, CellZeroRate: 0.0067, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 012/200 Summary -> Total: 156.6612, Diff: 0.0000, KL: 0.5816, Rec: 1.4161, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.2078, ZeroRate: 0.0961, CellZeroRate: 0.0067, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 013/200 Summary -> Total: 147.6046, Diff: 0.0000, KL: 0.5986, Rec: 1.4062, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.1951, ZeroRate: 0.0953, CellZeroRate: 0.0067, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 014/200 Summary -> Total: 139.5885, Diff: 0.0000, KL: 0.6151, Rec: 1.3963, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.1829, ZeroRate: 0.0945, CellZeroRate: 0.0067, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 015/200 Summary -> Total: 132.9488, Diff: 0.0000, KL: 0.6314, Rec: 1.3867, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.1702, ZeroRate: 0.0938, CellZeroRate: 0.0066, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 016/200 Summary -> Total: 126.9826, Diff: 0.0000, KL: 0.6477, Rec: 1.3766, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.1572, ZeroRate: 0.0930, CellZeroRate: 0.0066, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 017/200 Summary -> Total: 121.6792, Diff: 0.0000, KL: 0.6644, Rec: 1.3667, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.1442, ZeroRate: 0.0922, CellZeroRate: 0.0066, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 018/200 Summary -> Total: 116.1772, Diff: 0.0000, KL: 0.6812, Rec: 1.3570, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.1309, ZeroRate: 0.0915, CellZeroRate: 0.0065, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 019/200 Summary -> Total: 111.6935, Diff: 0.0000, KL: 0.6976, Rec: 1.3470, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.1172, ZeroRate: 0.0907, CellZeroRate: 0.0065, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 020/200 Summary -> Total: 107.4982, Diff: 0.0000, KL: 0.7126, Rec: 1.3375, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.1037, ZeroRate: 0.0899, CellZeroRate: 0.0065, LR: 4.000e-05
Checkpoint saved at: data/spatial_processed/train_k30/trainer_checkpoint_epoch_20.pt
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 021/200 Summary -> Total: 103.3349, Diff: 0.0000, KL: 0.7258, Rec: 1.3278, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.0901, ZeroRate: 0.0891, CellZeroRate: 0.0065, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 022/200 Summary -> Total: 99.9068, Diff: 0.0000, KL: 0.7382, Rec: 1.3188, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.0765, ZeroRate: 0.0883, CellZeroRate: 0.0064, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 023/200 Summary -> Total: 96.1281, Diff: 0.0000, KL: 0.7514, Rec: 1.3094, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.0625, ZeroRate: 0.0875, CellZeroRate: 0.0064, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 024/200 Summary -> Total: 92.5654, Diff: 0.0000, KL: 0.7652, Rec: 1.3004, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.0486, ZeroRate: 0.0867, CellZeroRate: 0.0064, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 025/200 Summary -> Total: 89.0642, Diff: 0.0000, KL: 0.7792, Rec: 1.2916, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.0350, ZeroRate: 0.0859, CellZeroRate: 0.0064, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 026/200 Summary -> Total: 86.1237, Diff: 0.0000, KL: 0.7937, Rec: 1.2831, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.0208, ZeroRate: 0.0851, CellZeroRate: 0.0063, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 027/200 Summary -> Total: 83.2203, Diff: 0.0000, KL: 0.8080, Rec: 1.2749, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 1.0069, ZeroRate: 0.0843, CellZeroRate: 0.0063, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 028/200 Summary -> Total: 80.1148, Diff: 0.0000, KL: 0.8220, Rec: 1.2667, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.9926, ZeroRate: 0.0835, CellZeroRate: 0.0063, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 029/200 Summary -> Total: 77.3765, Diff: 0.0000, KL: 0.8363, Rec: 1.2585, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.9782, ZeroRate: 0.0826, CellZeroRate: 0.0062, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 030/200 Summary -> Total: 74.5837, Diff: 0.0000, KL: 0.8506, Rec: 1.2508, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.9640, ZeroRate: 0.0818, CellZeroRate: 0.0062, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 031/200 Summary -> Total: 71.8159, Diff: 0.0000, KL: 0.8650, Rec: 1.2433, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.9495, ZeroRate: 0.0810, CellZeroRate: 0.0062, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 032/200 Summary -> Total: 69.1708, Diff: 0.0000, KL: 0.8797, Rec: 1.2357, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.9351, ZeroRate: 0.0802, CellZeroRate: 0.0061, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 033/200 Summary -> Total: 66.6911, Diff: 0.0000, KL: 0.8945, Rec: 1.2284, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.9205, ZeroRate: 0.0793, CellZeroRate: 0.0061, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 034/200 Summary -> Total: 64.0673, Diff: 0.0000, KL: 0.9097, Rec: 1.2212, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.9060, ZeroRate: 0.0785, CellZeroRate: 0.0061, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 035/200 Summary -> Total: 61.6083, Diff: 0.0000, KL: 0.9253, Rec: 1.2141, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.8914, ZeroRate: 0.0776, CellZeroRate: 0.0061, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 036/200 Summary -> Total: 59.1893, Diff: 0.0000, KL: 0.9413, Rec: 1.2073, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.8768, ZeroRate: 0.0768, CellZeroRate: 0.0060, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 037/200 Summary -> Total: 56.4049, Diff: 0.0000, KL: 0.9579, Rec: 1.2004, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.8620, ZeroRate: 0.0759, CellZeroRate: 0.0060, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 038/200 Summary -> Total: 54.1236, Diff: 0.0000, KL: 0.9749, Rec: 1.1938, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.8471, ZeroRate: 0.0751, CellZeroRate: 0.0060, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 039/200 Summary -> Total: 51.4632, Diff: 0.0000, KL: 0.9922, Rec: 1.1870, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.8321, ZeroRate: 0.0742, CellZeroRate: 0.0059, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 040/200 Summary -> Total: 48.9469, Diff: 0.0000, KL: 1.0103, Rec: 1.1804, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.8173, ZeroRate: 0.0733, CellZeroRate: 0.0059, LR: 4.000e-05
Checkpoint saved at: data/spatial_processed/train_k30/trainer_checkpoint_epoch_40.pt
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 041/200 Summary -> Total: 46.5274, Diff: 0.0000, KL: 1.0289, Rec: 1.1739, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.8022, ZeroRate: 0.0724, CellZeroRate: 0.0059, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 042/200 Summary -> Total: 44.3468, Diff: 0.0000, KL: 1.0476, Rec: 1.1675, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.7870, ZeroRate: 0.0715, CellZeroRate: 0.0058, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 043/200 Summary -> Total: 42.0007, Diff: 0.0000, KL: 1.0671, Rec: 1.1612, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.7719, ZeroRate: 0.0706, CellZeroRate: 0.0058, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 044/200 Summary -> Total: 39.5910, Diff: 0.0000, KL: 1.0867, Rec: 1.1550, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.7569, ZeroRate: 0.0697, CellZeroRate: 0.0058, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 045/200 Summary -> Total: 37.2707, Diff: 0.0000, KL: 1.1070, Rec: 1.1488, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.7416, ZeroRate: 0.0688, CellZeroRate: 0.0057, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 046/200 Summary -> Total: 35.0614, Diff: 0.0000, KL: 1.1280, Rec: 1.1427, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.7264, ZeroRate: 0.0679, CellZeroRate: 0.0057, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 047/200 Summary -> Total: 33.1473, Diff: 0.0000, KL: 1.1490, Rec: 1.1366, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.7112, ZeroRate: 0.0669, CellZeroRate: 0.0057, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 048/200 Summary -> Total: 30.8504, Diff: 0.0000, KL: 1.1709, Rec: 1.1307, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.6959, ZeroRate: 0.0660, CellZeroRate: 0.0056, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 049/200 Summary -> Total: 28.6412, Diff: 0.0000, KL: 1.1930, Rec: 1.1247, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.6807, ZeroRate: 0.0650, CellZeroRate: 0.0056, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 050/200 Summary -> Total: 26.7728, Diff: 0.0000, KL: 1.2159, Rec: 1.1189, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.6653, ZeroRate: 0.0641, CellZeroRate: 0.0056, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 051/200 Summary -> Total: 24.8812, Diff: 0.0000, KL: 1.2390, Rec: 1.1130, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.6501, ZeroRate: 0.0631, CellZeroRate: 0.0055, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 052/200 Summary -> Total: 22.9394, Diff: 0.0000, KL: 1.2628, Rec: 1.1073, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.6350, ZeroRate: 0.0622, CellZeroRate: 0.0055, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 053/200 Summary -> Total: 21.1029, Diff: 0.0000, KL: 1.2871, Rec: 1.1016, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.6197, ZeroRate: 0.0612, CellZeroRate: 0.0054, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 054/200 Summary -> Total: 19.4423, Diff: 0.0000, KL: 1.3116, Rec: 1.0960, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.6047, ZeroRate: 0.0602, CellZeroRate: 0.0054, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 055/200 Summary -> Total: 17.8911, Diff: 0.0000, KL: 1.3371, Rec: 1.0904, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.5896, ZeroRate: 0.0592, CellZeroRate: 0.0054, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 056/200 Summary -> Total: 16.2270, Diff: 0.0000, KL: 1.3630, Rec: 1.0848, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.5747, ZeroRate: 0.0582, CellZeroRate: 0.0053, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 057/200 Summary -> Total: 14.7261, Diff: 0.0000, KL: 1.3892, Rec: 1.0794, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.5597, ZeroRate: 0.0572, CellZeroRate: 0.0053, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 058/200 Summary -> Total: 13.2634, Diff: 0.0000, KL: 1.4157, Rec: 1.0739, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.5450, ZeroRate: 0.0562, CellZeroRate: 0.0052, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 059/200 Summary -> Total: 11.9710, Diff: 0.0000, KL: 1.4430, Rec: 1.0684, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.5301, ZeroRate: 0.0552, CellZeroRate: 0.0052, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 060/200 Summary -> Total: 10.7600, Diff: 0.0000, KL: 1.4706, Rec: 1.0630, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.5153, ZeroRate: 0.0542, CellZeroRate: 0.0052, LR: 4.000e-05
Checkpoint saved at: data/spatial_processed/train_k30/trainer_checkpoint_epoch_60.pt
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 061/200 Summary -> Total: 9.6380, Diff: 0.0000, KL: 1.4987, Rec: 1.0577, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.5008, ZeroRate: 0.0532, CellZeroRate: 0.0051, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 062/200 Summary -> Total: 8.6012, Diff: 0.0000, KL: 1.5273, Rec: 1.0523, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.4862, ZeroRate: 0.0521, CellZeroRate: 0.0051, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 063/200 Summary -> Total: 7.7000, Diff: 0.0000, KL: 1.5562, Rec: 1.0470, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.4717, ZeroRate: 0.0511, CellZeroRate: 0.0050, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 064/200 Summary -> Total: 6.8962, Diff: 0.0000, KL: 1.5858, Rec: 1.0416, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.4573, ZeroRate: 0.0500, CellZeroRate: 0.0050, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 065/200 Summary -> Total: 6.1914, Diff: 0.0000, KL: 1.6158, Rec: 1.0362, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.4428, ZeroRate: 0.0489, CellZeroRate: 0.0050, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 066/200 Summary -> Total: 5.6086, Diff: 0.0000, KL: 1.6462, Rec: 1.0309, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.4285, ZeroRate: 0.0478, CellZeroRate: 0.0049, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 067/200 Summary -> Total: 5.1295, Diff: 0.0000, KL: 1.6770, Rec: 1.0254, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.4141, ZeroRate: 0.0467, CellZeroRate: 0.0049, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 068/200 Summary -> Total: 4.7949, Diff: 0.0000, KL: 1.7079, Rec: 1.0200, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.3997, ZeroRate: 0.0456, CellZeroRate: 0.0048, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 069/200 Summary -> Total: 4.5991, Diff: 0.0000, KL: 1.7396, Rec: 1.0145, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.3856, ZeroRate: 0.0445, CellZeroRate: 0.0048, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 070/200 Summary -> Total: 4.5163, Diff: 0.0000, KL: 1.7692, Rec: 1.0093, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.3726, ZeroRate: 0.0435, CellZeroRate: 0.0047, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 071/200 Summary -> Total: 4.4743, Diff: 0.0000, KL: 1.7886, Rec: 1.0046, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.3609, ZeroRate: 0.0425, CellZeroRate: 0.0047, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 072/200 Summary -> Total: 4.4596, Diff: 0.0000, KL: 1.7944, Rec: 0.9999, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.3492, ZeroRate: 0.0416, CellZeroRate: 0.0046, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 073/200 Summary -> Total: 4.3896, Diff: 0.0000, KL: 1.7839, Rec: 0.9954, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.3382, ZeroRate: 0.0406, CellZeroRate: 0.0046, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 074/200 Summary -> Total: 4.2930, Diff: 0.0000, KL: 1.7536, Rec: 0.9910, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.3273, ZeroRate: 0.0397, CellZeroRate: 0.0045, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 075/200 Summary -> Total: 4.3476, Diff: 0.0000, KL: 1.7022, Rec: 0.9867, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.3170, ZeroRate: 0.0389, CellZeroRate: 0.0045, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 076/200 Summary -> Total: 4.4097, Diff: 0.0000, KL: 1.6839, Rec: 0.9825, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.3069, ZeroRate: 0.0380, CellZeroRate: 0.0045, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 077/200 Summary -> Total: 4.3558, Diff: 0.0000, KL: 1.6979, Rec: 0.9784, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.2973, ZeroRate: 0.0371, CellZeroRate: 0.0044, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 078/200 Summary -> Total: 4.2437, Diff: 0.0000, KL: 1.7342, Rec: 0.9745, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.2881, ZeroRate: 0.0363, CellZeroRate: 0.0044, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 079/200 Summary -> Total: 4.2590, Diff: 0.0000, KL: 1.7850, Rec: 0.9705, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.2789, ZeroRate: 0.0355, CellZeroRate: 0.0043, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 080/200 Summary -> Total: 4.3223, Diff: 0.0000, KL: 1.8108, Rec: 0.9667, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.2702, ZeroRate: 0.0347, CellZeroRate: 0.0043, LR: 4.000e-05
Checkpoint saved at: data/spatial_processed/train_k30/trainer_checkpoint_epoch_80.pt
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 081/200 Summary -> Total: 4.3117, Diff: 0.0000, KL: 1.8169, Rec: 0.9633, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.2623, ZeroRate: 0.0339, CellZeroRate: 0.0042, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 082/200 Summary -> Total: 4.2612, Diff: 0.0000, KL: 1.8076, Rec: 0.9601, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.2550, ZeroRate: 0.0332, CellZeroRate: 0.0042, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 083/200 Summary -> Total: 4.1441, Diff: 0.0000, KL: 1.7826, Rec: 0.9570, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.2481, ZeroRate: 0.0326, CellZeroRate: 0.0042, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 084/200 Summary -> Total: 4.1528, Diff: 0.0000, KL: 1.7382, Rec: 0.9540, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.2412, ZeroRate: 0.0319, CellZeroRate: 0.0041, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 085/200 Summary -> Total: 4.1963, Diff: 0.0000, KL: 1.7233, Rec: 0.9509, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.2344, ZeroRate: 0.0312, CellZeroRate: 0.0041, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 086/200 Summary -> Total: 4.1557, Diff: 0.0000, KL: 1.7311, Rec: 0.9480, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.2280, ZeroRate: 0.0306, CellZeroRate: 0.0040, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 087/200 Summary -> Total: 4.0789, Diff: 0.0000, KL: 1.7564, Rec: 0.9451, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.2219, ZeroRate: 0.0300, CellZeroRate: 0.0040, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 088/200 Summary -> Total: 4.0544, Diff: 0.0000, KL: 1.7955, Rec: 0.9422, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.2156, ZeroRate: 0.0293, CellZeroRate: 0.0039, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 089/200 Summary -> Total: 4.0717, Diff: 0.0000, KL: 1.8133, Rec: 0.9393, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.2095, ZeroRate: 0.0287, CellZeroRate: 0.0039, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 090/200 Summary -> Total: 4.0265, Diff: 0.0000, KL: 1.8131, Rec: 0.9366, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.2036, ZeroRate: 0.0281, CellZeroRate: 0.0038, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 091/200 Summary -> Total: 3.9652, Diff: 0.0000, KL: 1.7962, Rec: 0.9339, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1981, ZeroRate: 0.0275, CellZeroRate: 0.0038, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 092/200 Summary -> Total: 3.9771, Diff: 0.0000, KL: 1.7611, Rec: 0.9311, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1922, ZeroRate: 0.0268, CellZeroRate: 0.0037, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 093/200 Summary -> Total: 3.9836, Diff: 0.0000, KL: 1.7445, Rec: 0.9284, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1866, ZeroRate: 0.0262, CellZeroRate: 0.0037, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 094/200 Summary -> Total: 3.9352, Diff: 0.0000, KL: 1.7497, Rec: 0.9258, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1815, ZeroRate: 0.0257, CellZeroRate: 0.0036, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 095/200 Summary -> Total: 3.8424, Diff: 0.0000, KL: 1.7813, Rec: 0.9234, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1766, ZeroRate: 0.0251, CellZeroRate: 0.0036, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 096/200 Summary -> Total: 3.8181, Diff: 0.0000, KL: 1.8325, Rec: 0.9210, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1719, ZeroRate: 0.0246, CellZeroRate: 0.0035, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 097/200 Summary -> Total: 3.8009, Diff: 0.0000, KL: 1.8385, Rec: 0.9188, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1675, ZeroRate: 0.0241, CellZeroRate: 0.0035, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 098/200 Summary -> Total: 3.7290, Diff: 0.0000, KL: 1.8229, Rec: 0.9167, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1634, ZeroRate: 0.0236, CellZeroRate: 0.0035, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 099/200 Summary -> Total: 3.7224, Diff: 0.0000, KL: 1.7721, Rec: 0.9147, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1593, ZeroRate: 0.0231, CellZeroRate: 0.0034, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 100/200 Summary -> Total: 3.7414, Diff: 0.0000, KL: 1.7588, Rec: 0.9127, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1554, ZeroRate: 0.0227, CellZeroRate: 0.0034, LR: 4.000e-05
Checkpoint saved at: data/spatial_processed/train_k30/trainer_checkpoint_epoch_100.pt
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 101/200 Summary -> Total: 3.6603, Diff: 0.0000, KL: 1.7827, Rec: 0.9107, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1518, ZeroRate: 0.0222, CellZeroRate: 0.0034, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 102/200 Summary -> Total: 3.6289, Diff: 0.0000, KL: 1.8410, Rec: 0.9089, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1482, ZeroRate: 0.0218, CellZeroRate: 0.0033, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 103/200 Summary -> Total: 3.6470, Diff: 0.0000, KL: 1.8610, Rec: 0.9071, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1448, ZeroRate: 0.0214, CellZeroRate: 0.0033, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 104/200 Summary -> Total: 3.6118, Diff: 0.0000, KL: 1.8481, Rec: 0.9054, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1416, ZeroRate: 0.0210, CellZeroRate: 0.0033, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 105/200 Summary -> Total: 3.6286, Diff: 0.0000, KL: 1.8032, Rec: 0.9037, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1385, ZeroRate: 0.0206, CellZeroRate: 0.0032, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 106/200 Summary -> Total: 3.6162, Diff: 0.0000, KL: 1.8080, Rec: 0.9021, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1355, ZeroRate: 0.0203, CellZeroRate: 0.0032, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 107/200 Summary -> Total: 3.5801, Diff: 0.0000, KL: 1.8567, Rec: 0.9005, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1325, ZeroRate: 0.0199, CellZeroRate: 0.0032, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 108/200 Summary -> Total: 3.5599, Diff: 0.0000, KL: 1.8615, Rec: 0.8989, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1296, ZeroRate: 0.0195, CellZeroRate: 0.0031, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 109/200 Summary -> Total: 3.5373, Diff: 0.0000, KL: 1.8436, Rec: 0.8973, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1268, ZeroRate: 0.0192, CellZeroRate: 0.0031, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 110/200 Summary -> Total: 3.5302, Diff: 0.0000, KL: 1.8499, Rec: 0.8954, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1234, ZeroRate: 0.0187, CellZeroRate: 0.0030, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 111/200 Summary -> Total: 3.5244, Diff: 0.0000, KL: 1.8780, Rec: 0.8935, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1199, ZeroRate: 0.0183, CellZeroRate: 0.0030, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 112/200 Summary -> Total: 3.5108, Diff: 0.0000, KL: 1.8778, Rec: 0.8916, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1166, ZeroRate: 0.0179, CellZeroRate: 0.0030, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 113/200 Summary -> Total: 3.5265, Diff: 0.0000, KL: 1.8503, Rec: 0.8897, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1133, ZeroRate: 0.0174, CellZeroRate: 0.0029, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 114/200 Summary -> Total: 3.5303, Diff: 0.0000, KL: 1.8506, Rec: 0.8879, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1102, ZeroRate: 0.0170, CellZeroRate: 0.0029, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 115/200 Summary -> Total: 3.4895, Diff: 0.0000, KL: 1.8793, Rec: 0.8863, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1074, ZeroRate: 0.0166, CellZeroRate: 0.0028, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 116/200 Summary -> Total: 3.4955, Diff: 0.0000, KL: 1.9272, Rec: 0.8847, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1048, ZeroRate: 0.0163, CellZeroRate: 0.0028, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 117/200 Summary -> Total: 3.5035, Diff: 0.0000, KL: 1.9452, Rec: 0.8833, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1023, ZeroRate: 0.0160, CellZeroRate: 0.0028, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 118/200 Summary -> Total: 3.4752, Diff: 0.0000, KL: 1.9394, Rec: 0.8820, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.1001, ZeroRate: 0.0157, CellZeroRate: 0.0027, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 119/200 Summary -> Total: 3.4528, Diff: 0.0000, KL: 1.9100, Rec: 0.8807, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0981, ZeroRate: 0.0154, CellZeroRate: 0.0027, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 120/200 Summary -> Total: 3.4559, Diff: 0.0000, KL: 1.9065, Rec: 0.8795, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0960, ZeroRate: 0.0151, CellZeroRate: 0.0027, LR: 4.000e-05
Checkpoint saved at: data/spatial_processed/train_k30/trainer_checkpoint_epoch_120.pt
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 121/200 Summary -> Total: 3.4398, Diff: 0.0000, KL: 1.9279, Rec: 0.8783, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0940, ZeroRate: 0.0148, CellZeroRate: 0.0027, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 122/200 Summary -> Total: 3.4485, Diff: 0.0000, KL: 1.9626, Rec: 0.8768, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0916, ZeroRate: 0.0145, CellZeroRate: 0.0026, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 123/200 Summary -> Total: 3.4543, Diff: 0.0000, KL: 1.9716, Rec: 0.8755, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0895, ZeroRate: 0.0142, CellZeroRate: 0.0026, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 124/200 Summary -> Total: 3.4189, Diff: 0.0000, KL: 1.9557, Rec: 0.8743, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0875, ZeroRate: 0.0139, CellZeroRate: 0.0026, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 125/200 Summary -> Total: 3.4421, Diff: 0.0000, KL: 1.9157, Rec: 0.8731, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0857, ZeroRate: 0.0136, CellZeroRate: 0.0025, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 126/200 Summary -> Total: 3.4729, Diff: 0.0000, KL: 1.9060, Rec: 0.8720, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0839, ZeroRate: 0.0134, CellZeroRate: 0.0025, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 127/200 Summary -> Total: 3.4205, Diff: 0.0000, KL: 1.9280, Rec: 0.8710, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0824, ZeroRate: 0.0132, CellZeroRate: 0.0025, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 128/200 Summary -> Total: 3.3930, Diff: 0.0000, KL: 1.9724, Rec: 0.8701, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0809, ZeroRate: 0.0130, CellZeroRate: 0.0025, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 129/200 Summary -> Total: 3.4042, Diff: 0.0000, KL: 1.9879, Rec: 0.8691, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0795, ZeroRate: 0.0127, CellZeroRate: 0.0025, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 130/200 Summary -> Total: 3.3869, Diff: 0.0000, KL: 1.9793, Rec: 0.8682, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0781, ZeroRate: 0.0125, CellZeroRate: 0.0024, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 131/200 Summary -> Total: 3.3960, Diff: 0.0000, KL: 1.9485, Rec: 0.8673, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0768, ZeroRate: 0.0123, CellZeroRate: 0.0024, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 132/200 Summary -> Total: 3.4131, Diff: 0.0000, KL: 1.9444, Rec: 0.8665, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0755, ZeroRate: 0.0121, CellZeroRate: 0.0024, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 133/200 Summary -> Total: 3.3836, Diff: 0.0000, KL: 1.9646, Rec: 0.8657, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0743, ZeroRate: 0.0120, CellZeroRate: 0.0024, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 134/200 Summary -> Total: 3.3787, Diff: 0.0000, KL: 2.0011, Rec: 0.8649, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0732, ZeroRate: 0.0118, CellZeroRate: 0.0024, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 135/200 Summary -> Total: 3.3891, Diff: 0.0000, KL: 2.0127, Rec: 0.8642, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0721, ZeroRate: 0.0116, CellZeroRate: 0.0023, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 136/200 Summary -> Total: 3.3717, Diff: 0.0000, KL: 2.0034, Rec: 0.8635, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0710, ZeroRate: 0.0115, CellZeroRate: 0.0023, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 137/200 Summary -> Total: 3.3762, Diff: 0.0000, KL: 1.9739, Rec: 0.8628, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0700, ZeroRate: 0.0113, CellZeroRate: 0.0023, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 138/200 Summary -> Total: 3.3877, Diff: 0.0000, KL: 1.9673, Rec: 0.8621, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0690, ZeroRate: 0.0111, CellZeroRate: 0.0023, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 139/200 Summary -> Total: 3.3662, Diff: 0.0000, KL: 1.9850, Rec: 0.8614, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0680, ZeroRate: 0.0110, CellZeroRate: 0.0023, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 140/200 Summary -> Total: 3.3653, Diff: 0.0000, KL: 2.0199, Rec: 0.8608, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0671, ZeroRate: 0.0108, CellZeroRate: 0.0023, LR: 4.000e-05
Checkpoint saved at: data/spatial_processed/train_k30/trainer_checkpoint_epoch_140.pt
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 141/200 Summary -> Total: 3.3757, Diff: 0.0000, KL: 2.0306, Rec: 0.8602, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0662, ZeroRate: 0.0107, CellZeroRate: 0.0022, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 142/200 Summary -> Total: 3.3589, Diff: 0.0000, KL: 2.0219, Rec: 0.8596, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0653, ZeroRate: 0.0106, CellZeroRate: 0.0022, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 143/200 Summary -> Total: 3.3626, Diff: 0.0000, KL: 1.9943, Rec: 0.8590, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0645, ZeroRate: 0.0104, CellZeroRate: 0.0022, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 144/200 Summary -> Total: 3.3666, Diff: 0.0000, KL: 1.9883, Rec: 0.8584, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0636, ZeroRate: 0.0103, CellZeroRate: 0.0022, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 145/200 Summary -> Total: 3.3536, Diff: 0.0000, KL: 2.0023, Rec: 0.8578, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0628, ZeroRate: 0.0102, CellZeroRate: 0.0022, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 146/200 Summary -> Total: 3.3563, Diff: 0.0000, KL: 2.0328, Rec: 0.8572, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0620, ZeroRate: 0.0100, CellZeroRate: 0.0022, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 147/200 Summary -> Total: 3.3609, Diff: 0.0000, KL: 2.0424, Rec: 0.8566, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0612, ZeroRate: 0.0099, CellZeroRate: 0.0021, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 148/200 Summary -> Total: 3.3446, Diff: 0.0000, KL: 2.0322, Rec: 0.8561, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0604, ZeroRate: 0.0098, CellZeroRate: 0.0021, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 149/200 Summary -> Total: 3.3470, Diff: 0.0000, KL: 2.0049, Rec: 0.8556, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0597, ZeroRate: 0.0097, CellZeroRate: 0.0021, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 150/200 Summary -> Total: 3.3599, Diff: 0.0000, KL: 1.9987, Rec: 0.8550, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0589, ZeroRate: 0.0096, CellZeroRate: 0.0021, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 151/200 Summary -> Total: 3.3436, Diff: 0.0000, KL: 2.0127, Rec: 0.8545, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0582, ZeroRate: 0.0094, CellZeroRate: 0.0021, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 152/200 Summary -> Total: 3.3431, Diff: 0.0000, KL: 2.0442, Rec: 0.8540, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0575, ZeroRate: 0.0093, CellZeroRate: 0.0021, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 153/200 Summary -> Total: 3.3463, Diff: 0.0000, KL: 2.0524, Rec: 0.8535, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0568, ZeroRate: 0.0092, CellZeroRate: 0.0021, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 154/200 Summary -> Total: 3.3372, Diff: 0.0000, KL: 2.0439, Rec: 0.8530, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0561, ZeroRate: 0.0091, CellZeroRate: 0.0020, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 155/200 Summary -> Total: 3.3393, Diff: 0.0000, KL: 2.0179, Rec: 0.8525, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0554, ZeroRate: 0.0090, CellZeroRate: 0.0020, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 156/200 Summary -> Total: 3.3479, Diff: 0.0000, KL: 2.0113, Rec: 0.8520, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0547, ZeroRate: 0.0089, CellZeroRate: 0.0020, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 157/200 Summary -> Total: 3.3366, Diff: 0.0000, KL: 2.0233, Rec: 0.8515, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0541, ZeroRate: 0.0088, CellZeroRate: 0.0020, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 158/200 Summary -> Total: 3.3310, Diff: 0.0000, KL: 2.0511, Rec: 0.8510, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0534, ZeroRate: 0.0087, CellZeroRate: 0.0020, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 159/200 Summary -> Total: 3.3405, Diff: 0.0000, KL: 2.0585, Rec: 0.8505, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0527, ZeroRate: 0.0086, CellZeroRate: 0.0020, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Stage 2: diffusion loss on; denoiser unfrozen.
Epoch 160/200 Summary -> Total: 3.9059, Diff: 1.1603, KL: 2.0498, Rec: 0.8500, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0521, ZeroRate: 0.0085, CellZeroRate: 0.0020, LR: 4.000e-05
Checkpoint saved at: data/spatial_processed/train_k30/trainer_checkpoint_epoch_160.pt
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 161/200 Summary -> Total: 3.9051, Diff: 1.1447, KL: 2.0244, Rec: 0.8495, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0514, ZeroRate: 0.0084, CellZeroRate: 0.0020, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 162/200 Summary -> Total: 3.9076, Diff: 1.1361, KL: 2.0182, Rec: 0.8490, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0507, ZeroRate: 0.0083, CellZeroRate: 0.0019, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 163/200 Summary -> Total: 3.8891, Diff: 1.1284, KL: 2.0294, Rec: 0.8485, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0501, ZeroRate: 0.0081, CellZeroRate: 0.0019, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 164/200 Summary -> Total: 3.8745, Diff: 1.1134, KL: 2.0554, Rec: 0.8480, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0495, ZeroRate: 0.0080, CellZeroRate: 0.0019, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 165/200 Summary -> Total: 3.8773, Diff: 1.1122, KL: 2.0622, Rec: 0.8475, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0488, ZeroRate: 0.0079, CellZeroRate: 0.0019, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 166/200 Summary -> Total: 3.8622, Diff: 1.0980, KL: 2.0513, Rec: 0.8470, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0482, ZeroRate: 0.0078, CellZeroRate: 0.0019, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 167/200 Summary -> Total: 3.8817, Diff: 1.0951, KL: 2.0266, Rec: 0.8464, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0474, ZeroRate: 0.0077, CellZeroRate: 0.0019, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 168/200 Summary -> Total: 3.8781, Diff: 1.0863, KL: 2.0207, Rec: 0.8458, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0467, ZeroRate: 0.0076, CellZeroRate: 0.0019, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 169/200 Summary -> Total: 3.8575, Diff: 1.0797, KL: 2.0328, Rec: 0.8453, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0460, ZeroRate: 0.0075, CellZeroRate: 0.0018, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 170/200 Summary -> Total: 3.8407, Diff: 1.0758, KL: 2.0596, Rec: 0.8448, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0454, ZeroRate: 0.0074, CellZeroRate: 0.0018, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 171/200 Summary -> Total: 3.8350, Diff: 1.0698, KL: 2.0652, Rec: 0.8442, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0447, ZeroRate: 0.0073, CellZeroRate: 0.0018, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 172/200 Summary -> Total: 3.8246, Diff: 1.0648, KL: 2.0539, Rec: 0.8436, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0440, ZeroRate: 0.0071, CellZeroRate: 0.0018, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 173/200 Summary -> Total: 3.8190, Diff: 1.0599, KL: 2.0495, Rec: 0.8429, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0431, ZeroRate: 0.0070, CellZeroRate: 0.0018, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 174/200 Summary -> Total: 3.8115, Diff: 1.0564, KL: 2.0598, Rec: 0.8421, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0422, ZeroRate: 0.0068, CellZeroRate: 0.0018, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 175/200 Summary -> Total: 3.8056, Diff: 1.0551, KL: 2.0516, Rec: 0.8414, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0413, ZeroRate: 0.0067, CellZeroRate: 0.0017, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 176/200 Summary -> Total: 3.7961, Diff: 1.0553, KL: 2.0575, Rec: 0.8405, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0404, ZeroRate: 0.0065, CellZeroRate: 0.0017, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 177/200 Summary -> Total: 3.7959, Diff: 1.0493, KL: 2.0422, Rec: 0.8397, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0394, ZeroRate: 0.0064, CellZeroRate: 0.0017, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 178/200 Summary -> Total: 3.7824, Diff: 1.0420, KL: 2.0461, Rec: 0.8389, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0385, ZeroRate: 0.0062, CellZeroRate: 0.0017, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 179/200 Summary -> Total: 3.7790, Diff: 1.0374, KL: 2.0698, Rec: 0.8381, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0376, ZeroRate: 0.0061, CellZeroRate: 0.0017, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 180/200 Summary -> Total: 3.7742, Diff: 1.0352, KL: 2.0722, Rec: 0.8374, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0368, ZeroRate: 0.0059, CellZeroRate: 0.0016, LR: 4.000e-05
Checkpoint saved at: data/spatial_processed/train_k30/trainer_checkpoint_epoch_180.pt
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 181/200 Summary -> Total: 3.7608, Diff: 1.0323, KL: 2.0536, Rec: 0.8367, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0361, ZeroRate: 0.0058, CellZeroRate: 0.0016, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 182/200 Summary -> Total: 3.7670, Diff: 1.0303, KL: 2.0303, Rec: 0.8359, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0353, ZeroRate: 0.0057, CellZeroRate: 0.0016, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 183/200 Summary -> Total: 3.7596, Diff: 1.0305, KL: 2.0315, Rec: 0.8352, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0345, ZeroRate: 0.0055, CellZeroRate: 0.0016, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 184/200 Summary -> Total: 3.7462, Diff: 1.0370, KL: 2.0554, Rec: 0.8346, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0338, ZeroRate: 0.0054, CellZeroRate: 0.0016, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 185/200 Summary -> Total: 3.7350, Diff: 1.0252, KL: 2.0590, Rec: 0.8339, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0331, ZeroRate: 0.0053, CellZeroRate: 0.0016, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 186/200 Summary -> Total: 3.7346, Diff: 1.0262, KL: 2.0399, Rec: 0.8331, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0324, ZeroRate: 0.0052, CellZeroRate: 0.0015, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 187/200 Summary -> Total: 3.7291, Diff: 1.0253, KL: 2.0429, Rec: 0.8325, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0317, ZeroRate: 0.0050, CellZeroRate: 0.0015, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 188/200 Summary -> Total: 3.7217, Diff: 1.0222, KL: 2.0651, Rec: 0.8319, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0311, ZeroRate: 0.0049, CellZeroRate: 0.0015, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 189/200 Summary -> Total: 3.7168, Diff: 1.0236, KL: 2.0641, Rec: 0.8313, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0305, ZeroRate: 0.0048, CellZeroRate: 0.0015, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 190/200 Summary -> Total: 3.7170, Diff: 1.0204, KL: 2.0373, Rec: 0.8307, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0299, ZeroRate: 0.0047, CellZeroRate: 0.0015, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 191/200 Summary -> Total: 3.7169, Diff: 1.0203, KL: 2.0357, Rec: 0.8302, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0294, ZeroRate: 0.0046, CellZeroRate: 0.0015, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 192/200 Summary -> Total: 3.6990, Diff: 1.0174, KL: 2.0584, Rec: 0.8297, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0289, ZeroRate: 0.0046, CellZeroRate: 0.0015, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 193/200 Summary -> Total: 3.6971, Diff: 1.0198, KL: 2.0587, Rec: 0.8291, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0284, ZeroRate: 0.0045, CellZeroRate: 0.0014, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 194/200 Summary -> Total: 3.7044, Diff: 1.0149, KL: 2.0316, Rec: 0.8285, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0279, ZeroRate: 0.0044, CellZeroRate: 0.0014, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 195/200 Summary -> Total: 3.6998, Diff: 1.0155, KL: 2.0297, Rec: 0.8280, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0274, ZeroRate: 0.0043, CellZeroRate: 0.0014, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 196/200 Summary -> Total: 3.6843, Diff: 1.0149, KL: 2.0494, Rec: 0.8275, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0269, ZeroRate: 0.0042, CellZeroRate: 0.0014, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 197/200 Summary -> Total: 3.6960, Diff: 1.0113, KL: 2.0797, Rec: 0.8270, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0264, ZeroRate: 0.0041, CellZeroRate: 0.0014, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 198/200 Summary -> Total: 3.6990, Diff: 1.0127, KL: 2.0833, Rec: 0.8265, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0260, ZeroRate: 0.0040, CellZeroRate: 0.0014, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 199/200 Summary -> Total: 3.6751, Diff: 1.0094, KL: 2.0630, Rec: 0.8261, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0256, ZeroRate: 0.0040, CellZeroRate: 0.0014, LR: 4.000e-05
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.
Epoch 200/200 Summary -> Total: 3.6999, Diff: 1.0098, KL: 2.0139, Rec: 0.8257, MaskRec: 0.0000, SpecAlign: 0.0000, GeneStats: 0.0253, ZeroRate: 0.0039, CellZeroRate: 0.0013, LR: 4.000e-05
Checkpoint saved at: data/spatial_processed/train_k30/trainer_checkpoint_epoch_200.pt
Final trainer state saved at: data/spatial_processed/train_k30/trainer_final_state.pt

Training completed.

--- Starting Final Evaluation on Test Set ---
Processing data from H5/H5AD: data/visium_lymph_node.h5ad for test set.
Parameters: k=30, PE_dim=50, Gene Threshold=20, PCA Neighbors=50
SPLIT: Using TEST set (last 20%): 807 cells.
Warning: No counts layer/raw found. Inferred counts from X and stored in layers['counts'].
Initial GEX data shape: 807 cells, 36601 genes.
Using counts from: layers['counts']
Filtering genes expressed in fewer than 20 cells.
Number of genes after filtering: 14906
Building FEATURE graph (k=30) on PCA-reduced expression.
FEATURE Graph built: 34284 edges.
Building PHYSICAL graph (k=30) on Spatial Coordinates.
PHYSICAL Graph built: 26866 edges.
Computing Laplacian PE with dim 50...
Processed and saved data to data/spatial_processed/test_k30/processed/spatial_test_k30_pe50_gt20_pca50.pt
Saved metadata to data/spatial_processed/test_k30/processed/spatial_test_k30_pe50_gt20_pca50_metadata.pt
Processed file or metadata not found. Dataset will be processed.
Processing data from H5/H5AD: data/visium_lymph_node.h5ad for test set.
Parameters: k=30, PE_dim=50, Gene Threshold=20, PCA Neighbors=50
SPLIT: Using TEST set (last 20%): 807 cells.
Warning: No counts layer/raw found. Inferred counts from X and stored in layers['counts'].
Initial GEX data shape: 807 cells, 36601 genes.
Using counts from: layers['counts']
Filtering genes expressed in fewer than 20 cells.
Number of genes after filtering: 14906
Building FEATURE graph (k=30) on PCA-reduced expression.
FEATURE Graph built: 34284 edges.
Building PHYSICAL graph (k=30) on Spatial Coordinates.
PHYSICAL Graph built: 26866 edges.
Computing Laplacian PE with dim 50...
Processed and saved data to data/spatial_processed/test_k30/processed/spatial_test_k30_pe50_gt20_pca50.pt
Saved metadata to data/spatial_processed/test_k30/processed/spatial_test_k30_pe50_gt20_pca50_metadata.pt
Successfully loaded processed data from data/spatial_processed/test_k30/processed/spatial_test_k30_pe50_gt20_pca50.pt
Loaded metadata: 14906 filtered gene names, 3 cell types (['B cell', 'CD4-positive, alpha-beta T cell', 'lung pericyte']...).
Test data loaded: 807 cells.
Aligning test data to training feature space (Robust Strategy)...
DEBUG: Found 14906 / 17961 training genes in test set.
Test data aligned: 807 cells, 17961 genes.

Generating 3 datasets of size 807 for evaluation.
DEBUG: test_adata.obs columns: ['cell_type']
DEBUG: cell_type unique values: [0 1 2]
Generating conditionally based on real test set cell types.
Generating dataset 1/3...

Generating 807 samples...
Generation complete.
Evaluating generated dataset 1/3...

--- Computing Evaluation Metrics ---
Found 3 cell types in real data.
Applying normalization and log1p for evaluation.
Performing PCA to 30 dimensions.
Computing unconditional metrics.
Computing conditional metrics...
Evaluation metrics computation complete.
Metrics for dataset 1: {'MMD': {'Unconditional_Scale_0.01': 0.002478314796462655, 'Unconditional_Scale_0.1': 0.002478314796462655, 'Unconditional_Scale_1': 0.0034102213103324175, 'Unconditional_Scale_10': 0.30053770542144775, 'Unconditional_Scale_100': 0.23509609699249268, 'Conditional_Avg_Scale_0.01': 0.015062886523082852, 'Conditional_Avg_Scale_0.1': 0.015062886523082852, 'Conditional_Avg_Scale_1': 0.016300643095746636, 'Conditional_Avg_Scale_10': 0.3842945247888565, 'Conditional_Avg_Scale_100': 0.41395679116249084}, 'Wasserstein': {'Unconditional': 1.170003056526184, 'Conditional_Avg': 1.2023587822914124}}

--- Computing TSTR (Train on Synthetic, Test on Real) ---
TSTR Results -> Accuracy: 0.9083, F1 (weighted): 0.8647
TSTR: {'TSTR_Accuracy': 0.9083023543990086, 'TSTR_F1': 0.8646566568499653}

--- Computing GRN Recovery (Correlation Matrix Similarity) ---
GRN Recovery -> Matrix Norm Diff (Relative): 0.6533, Correlation of Correlations (Spearman): 0.4911
GRN: {'GRN_Diff_Norm': 0.653304068339397, 'GRN_Spearman': 0.4911303119930491}

--- Computing Marker Gene Conservation ---
Identifying Marker Genes in Real Data (Naive approach)...
Error Marker Genes: sequence item 0: expected str instance, int found
Generating dataset 2/3...

Generating 807 samples...
Generation complete.
Evaluating generated dataset 2/3...

--- Computing Evaluation Metrics ---
Found 3 cell types in real data.
Applying normalization and log1p for evaluation.
Performing PCA to 30 dimensions.
Computing unconditional metrics.
Computing conditional metrics...
Evaluation metrics computation complete.
Metrics for dataset 2: {'MMD': {'Unconditional_Scale_0.01': 0.002478314796462655, 'Unconditional_Scale_0.1': 0.002478314796462655, 'Unconditional_Scale_1': 0.003497246652841568, 'Unconditional_Scale_10': 0.314033567905426, 'Unconditional_Scale_100': 0.2446836233139038, 'Conditional_Avg_Scale_0.01': 0.015062886523082852, 'Conditional_Avg_Scale_0.1': 0.015062886523082852, 'Conditional_Avg_Scale_1': 0.016449213377200067, 'Conditional_Avg_Scale_10': 0.3998393416404724, 'Conditional_Avg_Scale_100': 0.42180556058883667}, 'Wasserstein': {'Unconditional': 1.1941601037979126, 'Conditional_Avg': 1.2199174165725708}}

--- Computing TSTR (Train on Synthetic, Test on Real) ---
TSTR Results -> Accuracy: 0.9083, F1 (weighted): 0.8647
TSTR: {'TSTR_Accuracy': 0.9083023543990086, 'TSTR_F1': 0.8646566568499653}

--- Computing GRN Recovery (Correlation Matrix Similarity) ---
GRN Recovery -> Matrix Norm Diff (Relative): 0.6973, Correlation of Correlations (Spearman): 0.4681
GRN: {'GRN_Diff_Norm': 0.6972985336168853, 'GRN_Spearman': 0.4680709155826512}

--- Computing Marker Gene Conservation ---
Identifying Marker Genes in Real Data (Naive approach)...
Error Marker Genes: sequence item 0: expected str instance, int found
Generating dataset 3/3...

Generating 807 samples...
Generation complete.
Evaluating generated dataset 3/3...

--- Computing Evaluation Metrics ---
Found 3 cell types in real data.
Applying normalization and log1p for evaluation.
Performing PCA to 30 dimensions.
Computing unconditional metrics.
Computing conditional metrics...
Evaluation metrics computation complete.
Metrics for dataset 3: {'MMD': {'Unconditional_Scale_0.01': 0.002478314796462655, 'Unconditional_Scale_0.1': 0.002478314796462655, 'Unconditional_Scale_1': 0.003497246652841568, 'Unconditional_Scale_10': 0.314033567905426, 'Unconditional_Scale_100': 0.2446836233139038, 'Conditional_Avg_Scale_0.01': 0.015062886523082852, 'Conditional_Avg_Scale_0.1': 0.015062886523082852, 'Conditional_Avg_Scale_1': 0.016449213377200067, 'Conditional_Avg_Scale_10': 0.3998393416404724, 'Conditional_Avg_Scale_100': 0.42180556058883667}, 'Wasserstein': {'Unconditional': 1.1941601037979126, 'Conditional_Avg': 1.2199174165725708}}

--- Computing TSTR (Train on Synthetic, Test on Real) ---
TSTR Results -> Accuracy: 0.9083, F1 (weighted): 0.8647
TSTR: {'TSTR_Accuracy': 0.9083023543990086, 'TSTR_F1': 0.8646566568499653}

--- Computing GRN Recovery (Correlation Matrix Similarity) ---
GRN Recovery -> Matrix Norm Diff (Relative): 0.6973, Correlation of Correlations (Spearman): 0.4647
GRN: {'GRN_Diff_Norm': 0.6972985336168853, 'GRN_Spearman': 0.46473273483796534}

--- Computing Marker Gene Conservation ---
Identifying Marker Genes in Real Data (Naive approach)...
Error Marker Genes: sequence item 0: expected str instance, int found

--- Computing Inpainting Evaluation Metrics (Mask Fraction: 0.2) ---
Performing Diffusion-Based Inpainting for 50 samples...
Inpainting MSE: 0.2487, Correlation: 0.3991

--- Computing Latent Interpolations (Geometric Surgery) ---
Sampling Z for each cell type (Conditional Generation)...
Computed interpolations for 3 pairs.

--- Computing Spatial Autocorrelation (Moran's I) ---
Average Moran's I (Top 50 Genes): 0.2686

--- Computing Spectral Mismatch ---
Spectral Mismatch (1 - avg_cosine_principal_angles): 0.8430

--- Generating Qualitative Plots in /home/lbini/cmu/works/laplace-DDPM/qualitative_evaluation_plots_v2/spatial_transformer_20260202_213014_6d66b04a65 for LapDDPM ---
Plotting Figure 1a: Mean-Variance Relationship...
Figure 1a saved.
Plotting Figure 1b: Zeros per Cell Distribution...
Figure 1b saved.
Plotting Figure 2: Joint UMAP for Real and Generated Data...
Figure 2 (Real Data UMAP) saved to /home/lbini/cmu/works/laplace-DDPM/qualitative_evaluation_plots_v2/spatial_transformer_20260202_213014_6d66b04a65/figure2_umap_real_cell_types_LapDDPM.png
Figure 2 (Generated Data UMAP) saved to /home/lbini/cmu/works/laplace-DDPM/qualitative_evaluation_plots_v2/spatial_transformer_20260202_213014_6d66b04a65/figure2_umap_generated_cell_types_LapDDPM.png
Qualitative plotting for LapDDPM finished.
Zero-rate calibration plots saved to /home/lbini/cmu/works/laplace-DDPM/qualitative_evaluation_plots_v2/spatial_transformer_20260202_213014_6d66b04a65/figure3_zero_rate_scatter_LapDDPM.png and /home/lbini/cmu/works/laplace-DDPM/qualitative_evaluation_plots_v2/spatial_transformer_20260202_213014_6d66b04a65/figure3_zero_rate_hist_LapDDPM.png

Script execution finished.
